<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>API</title>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
 <link rel="stylesheet" href="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.css">
    <script src="http://cdn.jsdelivr.net/chartist.js/latest/chartist.min.js"></script>
</head>



<body>


<h1 class="page-content"><a href="#" class="js-get">Get Data</a></h1>
  <h2>Year: <span class="year"></span></h2>
  <h2>Stockholm: <span class="sth"></span></h2>
  <h2>Gothenburg: <span class="gbg"></span></h2>
  <h2>Malm√∂: <span class="mlm"></span></h2>
  <h2>Sverge <span class="swe"></span></h2>
  <div class="ct-chart"></div>

<script>
var formated;

$(function(){

  $(".js-get").click(function(){

    var postURL = "http://api.scb.se/OV0104/v1/doris/sv/ssd/START/BO/BO0501/BO0501C/FastprisBRFRegionAr";
    var jsonData = {
  "query": [
    {
      "code": "Region",
      "selection": {
        "filter": "vs:Region99StorstadAEjAggr",
        "values": [
          "0010",
          "0020",
          "0030",
          "0060"
        ]
      }
    },
    {
      "code": "ContentsCode",
      "selection": {
        "filter": "item",
        "values": [
          "BO0501R6"
        ]
      }
    }
  ],
  "response": {
    "format": "json"
  }
};

$.post( postURL, JSON.stringify(jsonData), function(response) {
  console.log(data);
  formated = {
    sth: [],
    gbg: [],
    mlm: [],
    swe: []
  };
  var data = response["data"];
  for (var i = 0; i < data.length; i++) {
    var city = data[i]["key"][0];
    if (city === "0010") {
      formated["sth"].push((data[i]["values"][0]));
      console.log(data[i]["values"][0]);
    }
    if (city === "0020") {
      formated["gbg"].push((data[i]["values"][0]));
      console.log(data[i]["values"][0]);
    }
    if (city === "0030") {
      formated["mlm"].push((data[i]["values"][0]));
      console.log(data[i]["values"][0]);
    }
    if (city === "0060") {
      formated["swe"].push((data[i]["values"][0]));
      console.log(data[i]["values"][0]);
    }
  }
  console.log(formated);

  generateGraph();
  // var year = data.data[1].key[3]
  // var sthCount = data.data[0].values[0]
  // var gbgCount = data.data[0].values[0]
  // var mlmCount = data.data[0].values[0]
  // var sweCount = data.data[0].values[0]
  //
  // $(".year").html(year);
  // $(".sth").html(sthCount);
  // $(".gbg").html(gbgCount);
  // $(".mlm").html(mlmCount);
  // $(".swe").html(sweCount);
    });
  });
});
function generateGraph() {
  new Chartist.Line('.ct-chart', {
    labels: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday'],
    series: [
      formated["swe"],
      [2, 1, 3.5, 7, 3],
      [1, 3, 4, 5, 6]
    ]
  }, {
    fullWidth: true,
    chartPadding: {
      right: 100
    }
  });
}

</script>
</body>





</html>
